!function(){var n,t,e,r;n=pdmaptw.create({root:"#map",type:"town"}),t=[["縣市","鄉鎮"]],e={scale:d3.interpolateSpectral},r={},n.init().then(function(){var a,o,i,l,u;return n.fit(),a=n.lc.meta.name,n.lc.features.map(function(n){var e,o,i;return e=[a[n.properties.c],a[n.properties.t]],o=e[0],i=e[1],t.push([o,i]),(r[o]||(r[o]={}))[i]=n}),(o=function(){return d3.select(n.root).selectAll("path").attr("fill",function(n){var t;return t=(n.properties.value-e.min)/(e.max-e.min||1),e.scale(t)})})(),i=new Handsontable(sheet,{afterChange:function(){return t.map(function(n){if(r[n[0]])return r[n[0]][n[1]].properties.value=n[2]}),e.max=Math.max.apply(null,t.map(function(n){return n[2]||0})),e.min=Math.min.apply(null,t.map(function(n){return n[2]||0})),o()},data:t,rowHeaders:!0,colHeaders:!0,filters:!0,dropdownMenu:!0,stretchH:"all",rowHeights:25,minRows:50,minCols:15}),l=ldPalettePicker.init({ldcv:{}}),console.log(l[0].get),u=function(n){var t,r;return t=n.colors.map(function(n){return ldColor.hex(n)}),r=t.map(function(n,e){return e/(t.length-1)}),e.scale=d3.scaleLinear().domain(r).range(t).interpolate(d3.interpolateHcl),o()},l[0].get().then(function(n){return u(n)}),new ldView({root:document.body,action:{click:{palette:function(n){return n.node,l[0].get().then(function(n){return u(n)})},random:function(n){return n.node,t.map(function(n){return n[2]=Math.round(100*Math.random())}),i.loadData(t),i.render()}}}})})}();