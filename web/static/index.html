<!DOCTYPE html><html><head><link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/assets/lib/ldui/ldui.min.css"></head><body class="p-4"><div class="row" style="height:500px"><div class="col-md"><div class="aspect-ratio w-100" style="padding-top:120%"><svg class="border bg-light shadow w-100 h-100"><g></g></svg></div><div class="text-center"><div>Path Count: <span ld="count" data-name="county"></span></div><div ld="elapsed" data-name="county"></div><div ld="size" data-name="county"></div></div></div><div class="col-md"><div class="aspect-ratio w-100" style="padding-top:120%"><svg class="border bg-light shadow w-100 h-100"><g></g></svg></div><div class="text-center"><div>Path Count: <span ld="count" data-name="town"></span></div><div ld="elapsed" data-name="town"></div><div ld="size" data-name="town"></div></div></div><div class="col-md"><div class="aspect-ratio w-100" style="padding-top:120%"><svg class="border bg-light shadow w-100 h-100"><g></g></svg></div><div class="text-center"><div>Path Count: <span ld="count" data-name="village"></span></div><div ld="elapsed" data-name="village"></div><div ld="size" data-name="village"></div></div></div></div><script type="text/javascript" src="assets/lib/ldui/ldui.min.js"></script><script type="text/javascript" src="https://d3js.org/d3.v4.js"></script><script type="text/javascript" src="https://d3js.org/topojson.v2.min.js"></script><script type="text/javascript" src="https://d3js.org/d3-color.v1.min.js"></script><script type="text/javascript" src="https://d3js.org/d3-interpolate.v1.min.js"></script><script type="text/javascript" src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script><script type="text/javascript" src="assets/lib/twmap/twmap.min.js"></script><script>// Generated by LiveScript 1.3.1
var view, proc, svgs;
view = new ldView({
  root: document.body,
  handler: {
    "count": function(){},
    "elapsed": function(){}
  }
});
proc = function(root, fn, name){
  var t1;
  t1 = Date.now();
  return ld$.fetch(fn, {
    method: 'GET'
  }, {
    type: 'json'
  }).then(function(json){
    var size, t2, lc, bbox, path, features, g, bcr, ref$, width, height, padding, scale, w, h, t3;
    size = JSON.stringify(json).length;
    t2 = Date.now();
    lc = {
      blah: 0
    };
    bbox = topojson.bbox(json);
    path = d3.geoPath().projection(twmap.projection);
    features = topojson.feature(json, json.objects["out"]).features;
    console.log(topojson.bbox(json));
    d3.select(root).select("svg g").selectAll('path').data(features).enter().append('path').attr('d', path).attr('fill', function(){
      return d3.interpolateSpectral(Math.random());
    }).attr('stroke', function(){
      return '#000';
    }).attr('stroke-width', function(){
      return 0.005;
    });
    g = ld$.find(root, 'g', 0);
    bcr = root.getBoundingClientRect();
    bbox = g.getBBox();
    ref$ = [bcr.width, bcr.height], width = ref$[0], height = ref$[1];
    padding = 20;
    scale = Math.min((width - 2 * padding) / bbox.width, (height - 2 * padding) / bbox.height);
    ref$ = [width / 2, height / 2], w = ref$[0], h = ref$[1];
    console.log(scale);
    g.setAttribute('transform', "translate(" + w + "," + h + ") scale(" + scale + ") translate(" + (-bbox.x - bbox.width / 2) + "," + (-bbox.y - bbox.height / 2) + ")");
    ld$.find(document, "[ld=count][data-name=" + name, 0).innerText = features.length;
    t3 = Date.now();
    ld$.find(document, "[ld=elapsed][data-name=" + name, 0).innerText = "fetch: " + (t2 - t1) + "ms / render: " + (t3 - t2) + "ms";
    return ld$.find(document, "[ld=size][data-name=" + name, 0).innerText = "size: " + Math.round(size / 1024) + "KB";
  });
};
svgs = ld$.find(document.body, 'svg');
proc(svgs[0], 'assets/lib/twmap/county.topo.json', 'county');
proc(svgs[1], 'assets/lib/twmap/town.topo.json', 'town');
proc(svgs[2], 'assets/lib/twmap/village.topo.json', 'village');</script></body></html>